<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ì–æ–ª–æ–≤–Ω–∞</title>
  <link rel="stylesheet" href="css.css">
</head>
<body class="dark-theme">
  <header>
    <div class="logo">–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –°–∞–π—Ç–∞</div>
    <div class="Name">–ù–∞–∑–≤–∞ –°–∞–π—Ç—É</div>
    <nav>
      <ul>
        <li><a href="main.html">–ì–æ–ª–æ–≤–Ω–∞</a></li>
        <li><a href="main.html">–ö—É—Ä—Å–∏ –í–∞–ª—é—Ç</a></li>
        <li><a href="crypto.html">–ö—É—Ä—Å–∏ –ö—Ä–∏–ø—Ç–æ-–í–∞–ª—é—Ç</a></li>
        <li><a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç–∏</a></li>
        <li>–ó–º—ñ–Ω–∞ —Ç–µ–º–∏</li>
      </ul>
    </nav>
  </header>

  <main>
    <section class="bank-selection">
      <label for="bank">–û–±–µ—Ä—ñ—Ç—å –ë–∞–Ω–∫:</label>
      <select id="bank">
        <option value="privat">Privat24</option>
        <option value="oshchad">–û—â–∞–¥–±–∞–Ω–∫</option>
        <option value="nbu">–ù–ë–£</option>
        <option value="mono">–ú–æ–Ω–æ–±–∞–Ω–∫</option>
      </select>
    </section>

    <section class="currency-selection">
      <div class="currency-left">
        <label>–í–∏–±—Ä–∞–Ω–∞ –í–∞–ª—é—Ç–∞:</label>
        <select id="currency-left">
          <option value="uah">UAH</option>
          <option value="usd">USD</option>
          <option value="eur">EUR</option>
        </select>
        <input type="number" id="amount-left" placeholder="–í–≤–µ–¥—ñ—Ç—å —Å—É–º—É">
      </div>

      <button id="switch-currency">üîÑ</button>

      <div class="currency-right">
        <label>–í–∏–±—Ä–∞–Ω–∞ –í–∞–ª—é—Ç–∞:</label>
        <select id="currency-right">
          <option value="uah">UAH</option>
          <option value="usd">USD</option>
          <option value="eur">EUR</option>
        </select>
        <input type="number" id="amount-right" placeholder="–†–µ–∑—É–ª—å—Ç–∞—Ç" disabled>
      </div>
    </section>
  </main>

  <section class="exchange-rates">
    <h2>–ö—É—Ä—Å–∏ –í–∞–ª—é—Ç</h2>
    <table>
      <thead>
        <tr>
          <th>–ù–∞–∑–≤–∞ –ë–∞–Ω–∫—É</th>
          <th>USD</th>
          <th>EUR</th>
        </tr>
      </thead>
      <tbody>
        <tr id="privat-row"><td>Privat24</td><td>...</td><td>...</td></tr>
        <tr id="oshchad-row"><td>–û—â–∞–¥–±–∞–Ω–∫</td><td>...</td><td>...</td></tr>
        <tr id="nbu-row"><td>–ù–ë–£</td><td>...</td><td>...</td></tr>
        <tr id="mono-row"><td>–ú–æ–Ω–æ–±–∞–Ω–∫</td><td>...</td><td>...</td></tr>
      </tbody>
    </table>
  </section>

  <script>
    const rateData = {
      privat: {},
      mono: {},
      nbu: {},
      oshchad: { USD: 39.5, EUR: 42.2, UAH: 1 }
    };

    function updateConversion() {
      const bank = document.getElementById("bank").value;
      const from = document.getElementById("currency-left").value.toUpperCase();
      const to = document.getElementById("currency-right").value.toUpperCase();
      const amount = parseFloat(document.getElementById("amount-left").value);

      if (!rateData[bank] || !rateData[bank][from] || !rateData[bank][to] || isNaN(amount)) return;

      const result = (amount * rateData[bank][from]) / rateData[bank][to];
      document.getElementById("amount-right").value = result.toFixed(2);
    }

    document.querySelectorAll("select, input").forEach(el =>
      el.addEventListener("input", updateConversion)
    );

    document.getElementById("switch-currency").addEventListener("click", () => {
      const leftSel = document.getElementById("currency-left");
      const rightSel = document.getElementById("currency-right");
      [leftSel.value, rightSel.value] = [rightSel.value, leftSel.value];
      updateConversion();
    });

    // ‚úÖ –ü—Ä–∏–≤–∞—Ç–ë–∞–Ω–∫ —á–µ—Ä–µ–∑ CORS proxy
    fetch("https://corsproxy.io/?https://api.privatbank.ua/p24api/pubinfo?json&exchange&coursid=5")
      .then(res => res.json())
      .then(data => {
        rateData.privat.UAH = 1;
        data.forEach(item => {
          if (item.base_ccy === "UAH" && ["USD", "EUR"].includes(item.ccy)) {
            rateData.privat[item.ccy] = parseFloat(item.sale);
          }
        });
        updateConversion();
        updateTable();
      })
      .catch(err => console.error("–ü–æ–º–∏–ª–∫–∞ –ü—Ä–∏–≤–∞—Ç–ë–∞–Ω–∫—É:", err));

    // –ù–ë–£
    fetch("https://bank.gov.ua/NBUStatService/v1/statdirectory/exchange?json")
      .then(res => res.json())
      .then(data => {
        rateData.nbu.UAH = 1;
        data.forEach(item => {
          if (["USD", "EUR"].includes(item.cc)) {
            rateData.nbu[item.cc] = item.rate;
          }
        });
        updateConversion();
        updateTable();
      });

    // –ú–æ–Ω–æ–±–∞–Ω–∫
    fetch("https://api.monobank.ua/bank/currency")
      .then(res => res.json())
      .then(data => {
        rateData.mono.UAH = 1;
        data.forEach(item => {
          if (item.currencyCodeA === 840 && item.currencyCodeB === 980) {
            rateData.mono.USD = item.rateSell;
          }
          if (item.currencyCodeA === 978 && item.currencyCodeB === 980) {
            rateData.mono.EUR = item.rateSell;
          }
        });
        updateConversion();
        updateTable();
      });

    function updateTable() {
      document.getElementById("privat-row").innerHTML = `
        <td>Privat24</td>
        <td>${rateData.privat.USD?.toFixed(2) || '...'}</td>
        <td>${rateData.privat.EUR?.toFixed(2) || '...'}</td>
      `;
      document.getElementById("oshchad-row").innerHTML = `
        <td>–û—â–∞–¥–±–∞–Ω–∫</td>
        <td>${rateData.oshchad.USD.toFixed(2)}</td>
        <td>${rateData.oshchad.EUR.toFixed(2)}</td>
      `;
      document.getElementById("nbu-row").innerHTML = `
        <td>–ù–ë–£</td>
        <td>${rateData.nbu.USD?.toFixed(2) || '...'}</td>
        <td>${rateData.nbu.EUR?.toFixed(2) || '...'}</td>
      `;
      document.getElementById("mono-row").innerHTML = `
        <td>–ú–æ–Ω–æ–±–∞–Ω–∫</td>
        <td>${rateData.mono.USD?.toFixed(2) || '...'}</td>
        <td>${rateData.mono.EUR?.toFixed(2) || '...'}</td>
      `;
    }
  </script>
</body>
</html>

